<html>
<head>
  <base target="_blank">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="https://pbs.twimg.com/profile_images/1614420813800767490/mf6sQbCT_400x400.jpg" type="image/png">
  <link rel="manifest" href="/manifest.json">
</head>

<body>

  <p>quasimatt.com wrapped 2025</p>

  <p>
    @<input
      id="handleInput"
      type="text"
      placeholder="username"
      list="handleSuggestions"
      autocomplete="off"
      style="border:none; outline:none; font:inherit; width:16ch;"
    />
  </p>

  <datalist id="handleSuggestions"></datalist>

  <!-- OVERVIEW (UNCHANGED COPY) -->
  <div id="overview">
    <p>wow. 2025 sure was interesting. here's what's happened on quasimatt.com since 9/22/25.</p>

    <p>
      over 89 days, 210 individual people were mentioned on quasimatt.com.
      on average, people were mentioned on 4.7 days.
      112 people were mentioned only once.
      the day with the most mentions was 10/31 (halloween), with 33 people mentioned.
      the most social week mentioned 57 people.
      the least social week mentioned 10.
      an average of 6.5 people were mentioned per day,
      with the busiest days being saturday and friday and the quietest day being sunday.
      the strongest co-mentioned pair was mihir and jacob.
      the strongest co-mentioned trio was cass, maisy, and kathy.
      the most mentioned person was mihir, who appeared with 116 different people.
      the longest mention streak was john, who was mentioned 8 days in a row.
      the word "queen" appeared on quasimatt.com 54 times in 2025.
    </p>
  </div>

  <!-- PERSONAL WRAPPED -->
  <div id="result"></div>

  <script>
    let PEOPLE = null;

    fetch("/social/wrapped2025/wrapped2025_people.json")
      .then(r => r.json())
      .then(data => {
        PEOPLE = data;

        const list = document.getElementById("handleSuggestions");
        Object.keys(data).forEach(h => {
          const opt = document.createElement("option");
          opt.value = h;
          list.appendChild(opt);
        });

        const handleFromURL = window.location.search.replace("?", "");
        if (handleFromURL) {
          document.getElementById("handleInput").value = handleFromURL;
          renderWrapped(handleFromURL);
        }
      });

    function renderWrapped(raw) {
      const handle = raw.replace(/^@/, "").toLowerCase();
      const data = PEOPLE && PEOPLE[handle];

      document.getElementById("overview").style.display = "none";
      window.history.pushState({}, "", `?${handle}`);

      if (!data) {
        document.getElementById("result").innerHTML = `
          <p><strong>@${handle}</strong></p>
          <p>you have to be mentioned on at least 3 days to get a personalized wrapped. get your clout up.</p>
        `;
        return;
      }

      const topConnections = data.top_connections
        .map(c => `@${c.handle}`)
        .join(", ");

      document.getElementById("result").innerHTML = `
        <p><strong>@${handle}</strong></p>

        <p>
          you were mentioned on <strong>${data.days_seen}</strong> days this year
          (${data.days_seen_percentile}th percentile).
        </p>

        <p>
          you appeared with <strong>${data.connections}</strong> different people
          (${data.connections_percentile}th percentile).
        </p>

        <p>
          lately, our trajectory is <strong>${data.friendship_trend.label}</strong>.
        </p>

        <p>
          when you show up, itâ€™s usually in
          <strong>${data.social_style.replace("_", " ")}</strong> hangs
          (avg group size: ${data.avg_group_size}).
        </p>

        <p>
          we most often crossed paths on <strong>${data.top_weekday}</strong>s.
        </p>

        <p>
          you most often appeared alongside ${topConnections}.
        </p>
      `;
    }

    document.getElementById("handleInput").addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        renderWrapped(e.target.value);
      }
    });
  </script>

</body>
</html>
